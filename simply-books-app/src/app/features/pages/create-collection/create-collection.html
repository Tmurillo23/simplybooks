<div class="collection-form-container">
  <h2>Crear nueva colección</h2>

  <form (ngSubmit)="createCollection()" class="collection-form">

    <!-- Nombre -->
    <div class="form-group">
      <label>Nombre *</label>
      <input
        [(ngModel)]="name"
        name="name"
        type="text"
        placeholder="Nombre de la colección"
        class="form-input"
        required
      />
    </div>

    <!-- Descripción -->
    <div class="form-group">
      <label>Descripción</label>
      <textarea
        [(ngModel)]="description"
        name="description"
        placeholder="Describe brevemente tu colección"
        class="form-textarea"
      ></textarea>
    </div>

    <hr />

    <!-- Búsqueda de libros con dropdown -->
    <div class="book-search">
      <label>Agregar libros</label>
      <input
        [(ngModel)]="searchTerm"
        name="searchTerm"
        (input)="onSearch()"
        type="text"
        placeholder="Buscar en tu estantería..."
      />

      <!-- Dropdown de resultados -->
      @if (filteredBooks.length > 0) {
        <ul class="search-dropdown">
          @for (book of filteredBooks; track book.id) {
            <li (click)="addBook(book)">
              {{ book.title }}
            </li>
          }
        </ul>
      }
    </div>

    <!-- Libros seleccionados -->
    @if (selectedBooks.length > 0) {
      <div class="selected-books-section">
        <p class="selected-books-title">Libros añadidos:</p>
        <div class="selected-books-list">
          @for (book of selectedBooks; track book.id) {
            <span class="selected-book-item">
              {{ book.title }}
              <button
                type="button"
                (click)="removeBook(book)"
                class="remove-book-btn"
              >
                ×
              </button>
            </span>
          }
        </div>
      </div>
    }

    <!-- Botón crear -->
    <div class="form-actions">
      <button
        type="submit"
        class="btn-submit"
      >
        Crear colección
      </button>
    </div>
  </form>
</div>

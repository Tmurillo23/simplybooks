<div class="reviews-container">
  <h2>Mis rese√±as</h2>

  <!-- üîç Buscador -->
  <div class="search-bar">
    <input
      type="text"
      placeholder="Buscar rese√±a por t√≠tulo..."
      [value]="search()"
      (input)="search.set($any($event.target).value)"
    />
  </div>

  <!-- Bot√≥n para crear nueva rese√±a -->
  <div class="create-review-btn">
    <button [routerLink]="['/create-review']">Crear nueva rese√±a</button>
  </div>

  @if (filteredReviews().length === 0) {
    <p>No se encontraron rese√±as que coincidan.</p>
  }

  @for (review of filteredReviews(); track review.id) {
    <div class="review-card">
      <!-- üîπ T√≠tulo principal: t√≠tulo de la rese√±a -->
      <h3 class="review-title">
        <a
          [routerLink]="['/review', review.id]"
          class="review-link"
          title="Ver detalles de la rese√±a"
        >
          {{ review.title }}
        </a>
      </h3>

      <!-- üîπ Informaci√≥n secundaria: libro asociado -->
      <p class="book-info">
        <strong>Libro:</strong> {{ getBookTitle(review.bookId) }}
      </p>

      <p><strong>Calificaci√≥n:</strong> {{ review.rating }}‚òÖ</p>

      <p>
        <strong>Estado:</strong>
        <span [class.draft]="review.draft" [class.published]="!review.draft">
          {{ review.draft ? 'Borrador' : 'Publicado' }}
        </span>
      </p>

      <div class="actions">
        @if (review.draft) {
          <button [routerLink]="['/edit-review', review.id]">Editar</button>
          <button (click)="publish(review)">Publicar</button>
        }
        <button (click)="delete(review)">Eliminar</button>
      </div>
    </div>
  }
</div>
